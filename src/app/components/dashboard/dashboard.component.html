<div [class.bg-gray-900]="isDarkMode" [class.text-gray-100]="isDarkMode" class="flex min-h-screen">

  <!-- Sidebar -->
  <aside
    class="w-64 bg-gray-800/90 backdrop-blur-md text-white fixed inset-y-0 left-0 transform -translate-x-full md:translate-x-0 md:flex flex-col shadow-lg transition-transform duration-300"
    [class.translate-x-0]="isSidebarOpen">
    <div class="p-6 border-b border-gray-700 flex justify-between items-center">
      <h2 class="text-2xl font-bold text-blue-400">Dashboard</h2>
      <button class="md:hidden text-gray-300 hover:text-white" (click)="toggleSidebar()">‚úñ</button>
    </div>
    <nav class="flex-1 p-4 space-y-2">
      <button class="w-full text-left px-4 py-2 rounded transition-colors" [class.bg-blue-600]="activePage==='profile'"
        (click)="setActive('profile'); goToProfile()">Profile</button>
      <button class="w-full text-left px-4 py-2 rounded transition-colors" [class.bg-blue-600]="activePage==='users'"
        (click)="setActive('users')">Users</button>
      <button class="w-full text-left px-4 py-2 rounded transition-colors"
        [class.bg-blue-600]="activePage==='notifications'" (click)="setActive('notifications')">Notifications</button>
      <button class="w-full text-left px-4 py-2 rounded hover:bg-red-500/30 transition-colors"
        (click)="logout()">Logout</button>
    </nav>
  </aside>

  <!-- Main Content -->
  <div class="flex-1 flex flex-col md:ml-64 p-4">

    <!-- Theme Toggle -->
    <div class="flex justify-end mb-4">
      <button class="px-4 py-2 bg-gray-700 rounded hover:bg-gray-600" (click)="toggleTheme()">
        {{ isDarkMode ? 'üåô Dark' : '‚òÄÔ∏è Light' }}
      </button>
    </div>

    <!-- Users Page -->
    <div *ngIf="activePage==='users'">
      <div class="mb-4 flex justify-end">
        <button class="bg-green-500 px-4 py-2 rounded hover:bg-green-600" (click)="openAddModal()">Add User</button>
      </div>

      <div class="flex flex-col md:flex-row md:justify-between mb-4 gap-2">
        <input type="text" placeholder="Search users..." [(ngModel)]="searchText"
          class="px-3 py-2 rounded bg-gray-700 text-white outline-none w-full md:w-1/2">
        <button class="bg-blue-500 px-3 py-2 rounded hover:bg-blue-600" (click)="filterUsers()">Search</button>
      </div>

      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
        <div *ngFor="let user of filteredUsers" class="bg-gray-800/70 p-4 rounded-lg shadow hover:shadow-xl relative">
          <span class="absolute top-2 right-2 px-2 py-1 text-xs rounded font-semibold"
            [ngClass]="user.active ? 'bg-green-600' : 'bg-red-600'">
            {{ user.active ? 'Active' : 'Inactive' }}
          </span>
          <h3 class="text-lg font-bold text-white">{{ user.name }}</h3>
          <p class="text-gray-300">{{ user.email }}</p>
          <div class="mt-4 flex space-x-2">
            <button class="bg-yellow-500 px-2 py-1 rounded hover:bg-yellow-600 text-white text-sm"
              (click)="openEditModal(user)">Edit</button>
            <button class="bg-red-500 px-2 py-1 rounded hover:bg-red-600 text-white text-sm"
              (click)="openDeleteModal(user)">Delete</button>
          </div>
        </div>
        <div *ngIf="filteredUsers.length===0" class="col-span-full text-center text-gray-400 py-8">No users found</div>
      </div>
    </div>

    <!-- Profile Page -->
    <div *ngIf="activePage==='profile'" class="bg-gray-800/70 p-6 rounded shadow">
      <h2 class="text-lg font-bold mb-4">Your Profile</h2>
      <p><strong>Name:</strong> {{ currentUser?.name }}</p>
      <p><strong>Email:</strong> {{ currentUser?.email }}</p>
      <button class="mt-3 bg-blue-500 px-3 py-2 rounded hover:bg-blue-600" (click)="goToProfile()">Edit Profile</button>
    </div>
  </div>

  <!-- ADD / EDIT / DELETE / SUCCESS MODALS -->
  <div *ngIf="showAddModal" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50">
    <div class="bg-gray-800 p-6 rounded shadow w-full max-w-md">
      <div class="flex justify-between items-center mb-4">
        <h3 class="text-lg font-bold">Add User</h3>
        <button (click)="showAddModal=false" class="text-white">‚úñ</button>
      </div>
      <input [(ngModel)]="newUser.name" placeholder="Name" class="w-full px-3 py-2 rounded bg-gray-700 text-white mb-2">
      <input [(ngModel)]="newUser.email" placeholder="Email"
        class="w-full px-3 py-2 rounded bg-gray-700 text-white mb-2">
      <input [(ngModel)]="newUser.password" type="password" placeholder="Password"
        class="w-full px-3 py-2 rounded bg-gray-700 text-white mb-4">
      <div class="flex justify-end gap-2">
        <button class="bg-green-500 px-3 py-1 rounded hover:bg-green-600" (click)="saveNewUser()">Save</button>
        <button class="bg-gray-500 px-3 py-1 rounded hover:bg-gray-600" (click)="showAddModal=false">Cancel</button>
      </div>
    </div>
  </div>

  <div *ngIf="showEditModal" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50">
    <div class="bg-gray-800 p-6 rounded shadow w-full max-w-md">
      <div class="flex justify-between items-center mb-4">
        <h3 class="text-lg font-bold">Edit User</h3>
        <button (click)="showEditModal=false" class="text-white">‚úñ</button>
      </div>
      <input [(ngModel)]="editingUser.name" placeholder="Name"
        class="w-full px-3 py-2 rounded bg-gray-700 text-white mb-2">
      <input [(ngModel)]="editingUser.email" placeholder="Email"
        class="w-full px-3 py-2 rounded bg-gray-700 text-white mb-4">
      <div class="flex justify-end gap-2">
        <button class="bg-blue-500 px-3 py-1 rounded hover:bg-blue-600" (click)="saveUser()">Save</button>
        <button class="bg-gray-500 px-3 py-1 rounded hover:bg-gray-600" (click)="showEditModal=false">Cancel</button>
      </div>
    </div>
  </div>

  <div *ngIf="showDeleteModal" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50">
    <div class="bg-gray-800 p-6 rounded shadow w-full max-w-md">
      <div class="flex justify-between items-center mb-4">
        <h3 class="text-lg font-bold">Confirm Delete</h3>
        <button (click)="showDeleteModal=false" class="text-white">‚úñ</button>
      </div>
      <p>Are you sure you want to delete <strong>{{ deletingUser?.name }}</strong>?</p>
      <div class="flex justify-end gap-2 mt-4">
        <button class="bg-red-500 px-3 py-1 rounded hover:bg-red-600" (click)="confirmDelete()">Delete</button>
        <button class="bg-gray-500 px-3 py-1 rounded hover:bg-gray-600" (click)="showDeleteModal=false">Cancel</button>
      </div>
    </div>
  </div>

  <div *ngIf="showSuccessModal" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50">
    <div class="bg-gray-800 p-6 rounded shadow w-full max-w-sm text-center">
      <p class="mb-4">Action completed successfully ‚úÖ</p>
      <button class="bg-blue-500 px-3 py-1 rounded hover:bg-blue-600" (click)="closeSuccessModal()">OK</button>
    </div>
  </div>

</div>